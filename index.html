<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />

  <title>Spritkosten-Rechner â€“ Benzin, Diesel & Reisekosten berechnen</title>
  <meta name="description" content="Kostenloser Spritkosten-Rechner fÃ¼r Fahrten & Roadtrips. Berechne Spritkosten, Gesamtkosten, COâ‚‚-Bilanz sowie Maut-/Vignetten-SchÃ¤tzung mit Karte und Distanzberechnung weltweit." />
  <meta name="robots" content="index, follow" />

  <!-- âœ… DE â†” EN Connection (SEO) -->
  <link rel="canonical" href="https://spritkosten-check.de/" />
  <link rel="alternate" hreflang="de" href="https://spritkosten-check.de/" />
  <link rel="alternate" hreflang="en" href="https://petrolcostcalculator.com/" />
  <link rel="alternate" hreflang="x-default" href="https://petrolcostcalculator.com/" />

  <!-- Icons -->
  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
  <link rel="manifest" href="/site.webmanifest">
  <link rel="icon" href="/favicon.ico">

  <!-- Leaflet -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />

  <!-- Header Font -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@600;700;800&display=swap" rel="stylesheet">

  <!-- Google Ads -->
  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-4852698472752437"
    crossorigin="anonymous"></script>

  <!-- Schema -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "SoftwareApplication",
    "name": "Spritkosten-Rechner",
    "description": "Kostenloser Online-Rechner fÃ¼r Spritkosten, Kraftstoffpreise, CO2-Bilanz, Maut/Vignetten und Reisekosten",
    "url": "https://spritkosten-check.de",
    "applicationCategory": "UtilityApplication",
    "operatingSystem": "Web",
    "offers": {"@type":"Offer","price":"0","priceCurrency":"EUR"}
  }
  </script>

  <style>
    *{box-sizing:border-box;}

    :root{
      --bg1:#0f172a;
      --bg2:#e9eef5;
      --card:#ffffff;
      --muted:#4b5563;
      --text:#0b1220;
      --accent:#0ea5a3;
      --accent-2:#4f46e5;
      --button-h:48px;
      --maxw:1400px;
    }

    html{
      min-height:100%;
      background: linear-gradient(180deg, var(--bg1) 0%, var(--bg2) 100%);
      background-repeat:no-repeat;
      background-attachment:fixed;
    }
    body{
      margin:0;
      width:100%;
      font-family:Inter, system-ui, -apple-system, "Segoe UI", Roboto, Arial;
      color:var(--text);
      min-height:100vh;
      background:transparent;
      position:relative;
    }

    /* Header */
    .site-header{
      position: sticky;
      top:0;
      z-index: 2147483647;
      width:100%;
      background:#fff;
      border-bottom:1px solid rgba(15,23,42,0.06);
    }
    .header-inner{
      width:100%;
      max-width:none;
      margin:0;
      padding:10px 18px;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:12px;
      position: relative;
      z-index: 2147483647;
    }

    .logo-title{
      display:flex;
      align-items:center;
      gap:12px;
      text-decoration:none;
      color:inherit;
      flex:1 1 auto;
      min-width:0;
    }
    .logo-title:hover{opacity:.88;}
    .logo-title img{ height:54px; width:auto; display:block; }
    .site-title{
      font-family:'Poppins', Inter, system-ui, -apple-system, "Segoe UI", Roboto, Arial;
      font-weight:700;
      font-size:18px;
      white-space:nowrap;
      letter-spacing:.2px;
      max-width:560px;
      overflow:hidden;
      text-overflow:ellipsis;
    }

    .tabs{
      display:flex;
      gap:8px;
      margin-left:auto;
      flex:0 0 auto;
      align-items:center;
      flex-wrap:wrap;
      position: relative;
      z-index: 2147483647;
    }
    .tabs button,
    .tabs a.navbtn{
      background:transparent;
      border:1px solid transparent;
      color:var(--muted);
      padding:.6rem 1rem;
      border-radius:.6rem;
      cursor:pointer;
      font-weight:800;
      font-size:.95rem;
      height:var(--button-h);
      white-space:nowrap;
      text-decoration:none;
      display:inline-flex;
      align-items:center;
      justify-content:center;
    }
    .tabs button[aria-selected="true"]{
      background:linear-gradient(90deg,var(--accent),var(--accent-2));
      color:#fff;
    }
    .tabs a.navbtn:hover{opacity:.9;}
    .tabs a.navbtn.secondary{
      background:#eef2ff;
      color:var(--accent-2);
      border:1px solid rgba(79,70,229,0.12);
    }

    .lang-link{
      font-weight:800;
      text-decoration:none;
      color:var(--accent-2);
      border:1px solid rgba(79,70,229,0.15);
      background:#eef2ff;
      padding:.55rem .8rem;
      border-radius:.6rem;
      height:var(--button-h);
      display:inline-flex;
      align-items:center;
      position: relative;
      z-index: 2147483647;
    }

    /* Container */
    .page-container{
      width:100%;
      max-width: min(var(--maxw), 94vw);
      margin:0 auto;
      padding: 24px 12px 0 12px;
      display:flex;
      flex-direction:column;
      gap:18px;
    }
    @media (min-width: 992px){
      .page-container{
        padding-left:24px;
        padding-right:24px;
        padding-top:24px;
      }
    }

    h2{font-size:1.1rem;margin:16px 0 12px 0}

    .card{
      background:var(--card);
      border-radius:16px;
      padding:16px;
      box-shadow:0 12px 30px rgba(0,0,0,.08);
      border:1px solid rgba(15,23,42,0.05);
      width:100%;
      overflow:hidden;
    }

    .intro-section{ line-height:1.65; }
    .intro-section p{margin:0 0 12px 0;}
    .intro-section ul{margin:8px 0;padding-left:20px}
    .intro-section li{margin:6px 0}

    .layout{
      display:grid;
      grid-template-columns:minmax(0,420px) minmax(0,1fr);
      gap:16px;
      align-items:stretch;
      width:100%;
    }

    label{
      display:block;
      margin:.5rem 0 .25rem 0;
      font-size:.9rem;
      color:var(--muted);
      font-weight:600;
    }
    input[type="number"], input[type="text"], select{
      width:100%;
      padding:.6rem .75rem;
      border-radius:8px;
      border:1px solid rgba(15,23,42,0.10);
      background:transparent;
      color:var(--text);
      outline:none;
      font-size:1rem;
      margin-top:.25rem;
    }

    .km-row{display:flex;gap:8px;align-items:center;flex-wrap:nowrap}
    .km-row .km-input{flex:1;min-width:0}

    .spinner{display:flex;flex-direction:column;gap:6px}
    .spinner button{
      width:44px;height:44px;border-radius:8px;border:none;
      background:linear-gradient(90deg,var(--accent),var(--accent-2));
      color:#fff;font-weight:900;font-size:18px;cursor:pointer;
      display:inline-flex;align-items:center;justify-content:center
    }

    .big-action{display:flex;gap:10px;margin-top:12px;flex-wrap:wrap}
    .btn{
      flex:1;
      height:var(--button-h);
      border-radius:10px;
      border:none;
      cursor:pointer;
      font-weight:800;
      background:linear-gradient(90deg,var(--accent),var(--accent-2));
      color:#fff;
      font-size:1rem;
      min-width:140px;
      text-decoration:none;
      display:inline-flex;
      align-items:center;
      justify-content:center;
      padding:0 14px;
    }
    .btn.secondary{
      background:#eef2ff;
      color:var(--accent-2);
      border:1px solid rgba(79,70,229,0.12)
    }
    .btn.large{font-size:1.05rem;padding:0 14px;height:54px}

    .small{font-size:.9rem;color:var(--muted)}
    .hint{font-size:.85rem;color:var(--accent);margin-top:4px;min-height:18px;display:block}
    .hint.error{color:#e53e3e}
    .error{color:#e53e3e}

    .price-input-group{
      display:grid;
      grid-template-columns: 1fr auto;
      gap:10px;
      align-items:end;
      margin-top:8px;
    }
    .reset-price-btn{
      height:44px;
      padding:0 14px;
      white-space:nowrap;
    }

    .price-table{display:flex;gap:8px;margin-top:8px;flex-wrap:wrap}
    .price-card{
      flex:1;min-width:140px;padding:8px;border-radius:8px;background:#fafafa;
      border:1px solid rgba(15,23,42,0.05);text-align:center
    }
    .price-card strong{display:block;font-size:1.05rem;color:var(--accent-2);margin-top:6px}

    .resultbox{
      margin-top:12px;
      padding:12px;
      border-radius:8px;
      background:linear-gradient(180deg,#ffffff,#fbfdff);
      border:1px solid rgba(15,23,42,0.06)
    }
    .result-row{
      display:flex;justify-content:space-between;align-items:center;
      padding:6px 0;border-bottom:1px dashed rgba(15,23,42,0.10);gap:8px
    }
    .result-row:last-child{border-bottom:0}
    .result-key{color:var(--muted);font-size:.95rem}
    .result-val{font-weight:900;color:var(--accent-2)}

    /* DÃ¼nner Maut/Vignette-Block */
    .thinbox{
      margin-top:10px;
      padding:10px 12px;
      border-radius:10px;
      background:#ffffff;
      border:1px solid rgba(15,23,42,0.08);
    }
    .thinbox .title{
      font-weight:900;
      color:var(--accent-2);
      margin-bottom:6px;
      font-size:.95rem;
    }
    .thinbox .line{
      display:flex;justify-content:space-between;gap:10px;
      padding:5px 0;border-bottom:1px dashed rgba(15,23,42,0.10);
      font-size:.9rem;
    }
    .thinbox .line:last-child{border-bottom:0}
    .mono{font-variant-numeric:tabular-nums;}

    .price-mode{
      margin-top:10px;
      padding:10px;
      border:1px solid rgba(15,23,42,0.08);
      border-radius:10px;
      background:#fbfdff;
      display:none;
    }
    .price-mode .row{display:flex;gap:10px;flex-wrap:wrap;align-items:center}
    .pill{
      display:inline-flex;align-items:center;gap:8px;
      padding:8px 10px;border:1px solid rgba(15,23,42,0.10);
      border-radius:999px;background:#fff; cursor:pointer;
      user-select:none;
    }
    .pill input{margin:0}

    .country-badge{margin-top:8px; min-height:18px; font-size:.85rem; color:var(--muted);}

    /* âœ… Map etwas kleiner */
    #map{
      width:100%;
      height:520px;
      min-height:320px;
      border-radius:10px;
      border:1px solid rgba(15,23,42,0.10);
      background:#fff;
    }
    @media(max-width:980px){
      #map{height:260px !important;}
    }

    .ad-block{ margin:0; }

    .two-col{
      display:grid;
      grid-template-columns:1fr 1fr;
      gap:12px;
    }

    @media(max-width:980px){
      .layout{grid-template-columns:1fr}
      .spinner button{width:38px;height:38px}
      .two-col{grid-template-columns:1fr}
    }
    @media(max-width:720px){
      .header-inner{padding:10px 12px}
      .site-title{max-width:160px;}
      .tabs button,.tabs a.navbtn{padding:.5rem .7rem;height:42px;font-size:.9rem}
      .lang-link{height:42px;padding:.5rem .7rem}
      .big-action{flex-direction:column}
      .btn{width:100%}
      .price-input-group{ grid-template-columns: 1fr; }
      .reset-price-btn{ width:100%; }
    }
    @media(max-width:420px){
      .site-title{display:none;}
    }

    footer, footer *{ color:#000 !important; opacity:1 !important; }
    footer{ padding:18px 0 30px 0; }
    footer a{ text-decoration:none; }
    footer a:hover{ text-decoration:underline; }

    /* âœ… Rechte Spalte als Flex; CO2 wird nach unten gedrÃ¼ckt (bÃ¼ndiger Abschluss zum linken Block, wenn Platz da ist) */
    .map-col{
      display:flex;
      flex-direction:column;
      height:100%;
    }
    .push-bottom{ flex:1; min-height:8px; }

    /* âœ… CO2 & Vergleich */
    .co2box{
      margin-top:10px;
      padding:12px;
      border-radius:12px;
      background:linear-gradient(180deg,#ffffff,#fbfdff);
      border:1px solid rgba(15,23,42,0.08);
    }
    .co2box .title{
      font-weight:900;
      color:var(--accent-2);
      margin-bottom:8px;
      display:flex;
      gap:8px;
      align-items:center;
    }
    .co2box .grid{
      display:grid;
      grid-template-columns:1fr 1fr;
      gap:10px;
    }
    .co2-kpi{
      padding:10px;
      border-radius:10px;
      background:#fff;
      border:1px solid rgba(15,23,42,0.06);
    }
    .co2-kpi .k{ color:var(--muted); font-size:.9rem; }
    .co2-kpi .v{ font-weight:900; color:var(--accent-2); font-size:1.05rem; margin-top:4px; }
    .co2-note{
      margin-top:10px;
      font-size:.85rem;
      color:var(--muted);
      line-height:1.55;
    }
    .compare{
      margin-top:12px;
      padding:10px;
      border-radius:10px;
      background:#eef2ff;
      border:1px solid rgba(79,70,229,0.12);
    }
    .compare h3{
      margin:0 0 8px 0;
      font-size:1rem;
      color:var(--accent-2);
    }
    .compare .row{
      display:flex;
      justify-content:space-between;
      gap:12px;
      padding:6px 0;
      border-bottom:1px dashed rgba(15,23,42,0.12);
    }
    .compare .row:last-child{ border-bottom:0; }
    .compare .lbl{ color:var(--muted); font-size:.9rem; }
    .compare .val{ font-weight:900; color:var(--accent-2); }
    @media(max-width:720px){
      .co2box .grid{ grid-template-columns:1fr; }
    }
  </style>
</head>

<body>
  <header class="site-header">
    <div class="header-inner">
      <a href="/" class="logo-title">
        <img src="/logo.png" alt="Spritkosten-Check Logo">
        <span class="site-title">Spritkosten-Rechner â€“ Benzin & Reisekosten berechnen</span>
      </a>

      <!-- âœ… Oben gut sichtbar: Rechner + Ratgeber/FAQ + Taschenrechner -->
      <nav class="tabs" role="tablist" aria-label="Hauptnavigation">
        <button role="tab" data-target="fuel" aria-selected="true">Spritkosten-Rechner</button>
        <button role="tab" data-target="calc" aria-selected="false">Taschenrechner</button>

        <a class="navbtn secondary" href="/guenstig-tanken.html">GÃ¼nstig tanken</a>
        <a class="navbtn secondary" href="/ratgeber.html">Ratgeber</a>
        <a class="navbtn secondary" href="/faq.html">FAQ</a>

        <a class="lang-link" href="https://petrolcostcalculator.com/" hreflang="en" lang="en" title="English">EN</a>
      </nav>
    </div>
  </header>

  <div class="page-container">

    <!-- Ad: Top -->
    <div class="ad-block">
      <ins class="adsbygoogle"
        style="display:block"
        data-ad-client="ca-pub-4852698472752437"
        data-ad-slot="7158625008"
        data-ad-format="auto"
        data-full-width-responsive="true"></ins>
      <script>(adsbygoogle = window.adsbygoogle || []).push({});</script>
    </div>

    <!-- Intro -->
    <section class="card intro-section" aria-label="EinfÃ¼hrung Spritkosten-Rechner">
      <h2>Kostenloser Spritkosten-Rechner â€“ Plane deine Fahrtkosten</h2>
      <p>
        Unser <strong>Spritkosten-Rechner</strong> hilft dir, die Gesamtkosten deiner Fahrt zu schÃ¤tzen.
        Gib Strecke, Verbrauch und Spritpreis ein â€“ du erhÃ¤ltst eine AufschlÃ¼sselung aus Spritkosten, laufenden Kosten
        und einer Maut-/Vignetten-SchÃ¤tzung. ZusÃ¤tzlich bekommst du eine grobe <strong>COâ‚‚-Bilanz</strong> und einen Vergleich
        von <strong>Auto vs. Bahn/Flug</strong>.
      </p>
      <ul>
        <li><strong>Weltweit:</strong> Orte (StÃ¤dte/DÃ¶rfer) per OpenStreetMap</li>
        <li><strong>Strecke:</strong> echte StraÃŸenroute (OSRM) + Karte</li>
        <li><strong>Maut/Vignette:</strong> schnelle SchÃ¤tzung nach LÃ¤ndern</li>
        <li><strong>COâ‚‚:</strong> SchÃ¤tzung fÃ¼r Fahrt + pro Person</li>
        <li><strong>Kosten teilen:</strong> pro Person berechnen</li>
      </ul>
    </section>

    <main aria-label="Hauptinhalt">
      <section id="fuel" class="card" aria-hidden="false">

        <!-- Ad: Middle -->
        <div class="ad-block">
          <ins class="adsbygoogle"
            style="display:block"
            data-ad-client="ca-pub-4852698472752437"
            data-ad-slot="3355111369"
            data-ad-format="auto"
            data-full-width-responsive="true"></ins>
          <script>(adsbygoogle = window.adsbygoogle || []).push({});</script>
        </div>

        <div class="layout">
          <!-- âœ… Linke Spalte: Eingaben + Ergebnisse -->
          <div>
            <h2 style="margin:0 0 8px 0;font-size:1rem">Eingaben</h2>

            <label for="km">Strecke (km) â€” oder per Start/Ziel berechnen</label>
            <div class="km-row">
              <input id="km" class="km-input" type="number" inputmode="decimal" min="0" step="0.1"
                placeholder="z. B. 120,5" aria-label="Strecke in Kilometern" />
              <div class="spinner" title="Strecke erhÃ¶hen / verringern">
                <button id="km-inc" aria-label="Strecke erhÃ¶hen">â–²</button>
                <button id="km-dec" aria-label="Strecke verringern">â–¼</button>
              </div>
            </div>

            <div style="margin-top:12px">
              <label for="place-from">Oder: Start (Ort, Land)</label>
              <input id="place-from" type="text" placeholder="z. B. Moskau, Russland" aria-label="Startort" />
              <label for="place-to" style="margin-top:10px">Ziel (Ort, Land)</label>
              <input id="place-to" type="text" placeholder="z. B. Sankt Petersburg, Russland" aria-label="Zielort" />

              <div class="map-controls" style="margin-top:10px;display:flex;gap:8px;flex-wrap:wrap">
                <button id="btn-geocode" class="btn secondary">Strecke berechnen</button>
                <button id="btn-clearmap" class="btn secondary">Karte zurÃ¼cksetzen</button>
              </div>

              <div class="country-badge" id="country-badge"></div>

              <div class="price-mode" id="price-mode">
                <div class="small" style="margin-bottom:6px;">
                  Startland und Zielland sind unterschiedlich. Welcher Spritpreis soll gelten?
                </div>
                <div class="row">
                  <label class="pill"><input type="radio" name="priceMode" value="start"> Startland</label>
                  <label class="pill"><input type="radio" name="priceMode" value="avg" checked> Mittelwert</label>
                  <label class="pill"><input type="radio" name="priceMode" value="dest"> Zielland</label>
                </div>
              </div>
              <!-- âœ… Satz "Orte via ..." ist entfernt -->
            </div>

            <label for="fuel-type" style="margin-top:12px">Kraftstoff</label>
            <select id="fuel-type" aria-label="Kraftstoff">
              <option value="unleaded91">Benzin (E10/91)</option>
              <option value="unleaded95">Super (E5 / 95)</option>
              <option value="diesel">Diesel</option>
            </select>

            <label for="consumption" style="margin-top:12px">Verbrauch (L/100 km)</label>
            <input id="consumption" type="number" inputmode="decimal" min="0" step="0.1"
              value="7.5" placeholder="z. B. 7,5" aria-label="Kraftstoffverbrauch" />

            <div class="price-input-group">
              <div>
                <label for="price">Preis pro Liter (â‚¬)</label>
                <input id="price" type="number" inputmode="decimal" min="0" step="0.01"
                  placeholder="z. B. 1,89" aria-label="Spritpreis pro Liter" />
                <span id="price-info" class="hint"></span>
              </div>

              <button id="btn-reset-price" class="btn secondary reset-price-btn">
                Auf Standard zurÃ¼cksetzen
              </button>
            </div>

            <div class="price-table" aria-hidden="false">
              <div class="price-card">
                <div class="small">Ã˜ Benzin (E10)</div>
                <strong id="avg-unleaded91">â€”</strong>
              </div>
              <div class="price-card">
                <div class="small">Ã˜ Super (E5)</div>
                <strong id="avg-unleaded95">â€”</strong>
              </div>
              <div class="price-card">
                <div class="small">Ã˜ Diesel</div>
                <strong id="avg-diesel">â€”</strong>
              </div>
            </div>

            <label for="passengers" style="margin-top:12px">Personen (inkl. Fahrer)</label>
            <input id="passengers" type="number" min="1" step="1" value="1" aria-label="Anzahl Personen" />

            <div class="big-action">
              <button id="calc-fuel" class="btn large">Berechnen</button>
              <button id="reset-fuel" class="btn secondary large">ZurÃ¼cksetzen</button>
            </div>

            <div class="resultbox" aria-live="polite" aria-label="Ergebnisse">
              <div class="result-row"><div class="result-key">Spritkosten</div><div class="result-val" id="cost-fuel">â‚¬0,00</div></div>
              <div class="result-row"><div class="result-key">Laufende Kosten inkl. Maut/Vignette (SchÃ¤tzung)</div><div class="result-val" id="cost-running">â‚¬0,00</div></div>
              <div class="result-row"><div class="result-key">Gesamtkosten</div><div class="result-val" id="cost-total">â‚¬0,00</div></div>
              <div class="result-row"><div class="result-key">Pro Person</div><div class="result-val" id="cost-person">â‚¬0,00</div></div>
              <div class="result-row"><div class="result-key">Liter gesamt</div><div class="result-val" id="liters">0,00 L</div></div>
              <div class="result-row"><div class="result-key">Durchschnitt (â‚¬/100 km)</div><div class="result-val" id="avg100">â‚¬0,00 /100km</div></div>
              <div class="result-row"><div class="result-key small">SchÃ¤tzung laufende Kosten /100 km (inkl. Maut/Vignette)</div><div class="result-val small" id="running-est">â€”</div></div>
              <div style="margin-top:8px;color:var(--muted);font-size:.85rem">
                Laufende Kosten enthalten: Wartung, Reifen, Wertverlust, Versicherung + Maut/Vignette-SchÃ¤tzung.
              </div>
            </div>
          </div>

          <!-- âœ… Rechte Spalte: Map + Maut/Vignette; CO2 wird nach unten geschoben -->
          <div class="map-col">
            <h2 style="margin:0 0 8px 0;font-size:1rem">Karte & Strecke</h2>
            <div id="map"></div>

            <div style="margin-top:8px" class="small">
              Klicke â€žStrecke berechnenâ€œ, um Start/Ziel zu finden. Die Strecke ist eine echte StraÃŸenroute (OSRM).
            </div>
            <div id="toll-info" class="small" style="margin-top:6px;color:var(--muted)"></div>

            <!-- âœ… Maut/Vignette bleibt so wie es ist -->
            <div class="thinbox" aria-label="Maut und Vignetten Details">
              <div class="title">Maut & Vignette â€“ Details</div>
              <div class="line"><div>Gesamt Maut</div><div class="mono" id="toll-total">â€”</div></div>
              <div class="line"><div>Gesamt Vignetten</div><div class="mono" id="vignette-total">â€”</div></div>
              <div class="line"><div>Summe Maut + Vignette</div><div class="mono" id="toll-vignette-sum">â€”</div></div>
              <div style="margin-top:8px" class="small" id="toll-breakdown"></div>
            </div>

            <!-- âœ… Spacer: drÃ¼ckt CO2 nach unten, damit es bÃ¼ndiger mit linkem Block endet (wenn Platz vorhanden) -->
            <div class="push-bottom" aria-hidden="true"></div>

            <!-- âœ… COâ‚‚-Bilanz & Vergleich -->
            <div class="co2box" aria-label="CO2 Bilanz und Vergleich">
              <div class="title">ðŸŒ± COâ‚‚-Bilanz deiner Fahrt</div>

              <div class="grid">
                <div class="co2-kpi">
                  <div class="k">Kraftstoff gesamt</div>
                  <div class="v" id="co2-liters">â€”</div>
                </div>
                <div class="co2-kpi">
                  <div class="k">COâ‚‚ gesamt (SchÃ¤tzung)</div>
                  <div class="v" id="co2-total">â€”</div>
                </div>
                <div class="co2-kpi">
                  <div class="k">COâ‚‚ pro Person</div>
                  <div class="v" id="co2-per-person">â€”</div>
                </div>
                <div class="co2-kpi">
                  <div class="k">COâ‚‚ pro 100 km</div>
                  <div class="v" id="co2-per-100">â€”</div>
                </div>
              </div>

              <div class="compare" aria-label="Vergleich Auto vs Bahn Flug">
                <h3>Vergleich: Auto vs. Bahn/Flug (grobe SchÃ¤tzung)</h3>
                <div class="row"><div class="lbl">Auto (deine Eingaben)</div><div class="val" id="cmp-car">â€”</div></div>
                <div class="row"><div class="lbl">Bahn (typisch)</div><div class="val" id="cmp-rail">â€”</div></div>
                <div class="row"><div class="lbl">Flug (typisch)</div><div class="val" id="cmp-flight">â€”</div></div>
                <div class="co2-note">
                  Hinweis: Vergleichswerte sind Durchschnittswerte pro Person-km und dienen nur als Orientierung.
                </div>
              </div>

              <div class="co2-note">
                COâ‚‚-Werte sind SchÃ¤tzungen und hÃ¤ngen u. a. von Fahrzeug, Fahrstil, Beladung und Streckenprofil ab.
              </div>
            </div>

          </div>
        </div>
      </section>

      <!-- Taschenrechner Tab -->
      <section id="calc" class="card" aria-hidden="true" style="display:none">
        <h2>Taschenrechner</h2>
        <label for="num1">Zahl 1</label>
        <input id="num1" type="number" inputmode="decimal" placeholder="Zahl 1" />
        <label for="num2">Zahl 2</label>
        <input id="num2" type="number" inputmode="decimal" placeholder="Zahl 2" />

        <div style="display:grid;grid-template-columns:1fr 1fr;gap:8px;margin-top:10px;max-width:240px">
          <button data-op="+" class="btn" style="height:44px;font-size:1.1rem">+</button>
          <button data-op="-" class="btn" style="height:44px;font-size:1.1rem">âˆ’</button>
          <button data-op="*" class="btn" style="height:44px;font-size:1.1rem">Ã—</button>
          <button data-op="/" class="btn" style="height:44px;font-size:1.1rem">Ã·</button>
        </div>

        <p style="margin-top:12px" class="small">Ergebnis: <strong id="result">â€“</strong></p>
      </section>
    </main>

    <!-- Footer -->
    <footer class="small">
      Kostenloser Spritkosten-Rechner fÃ¼r Deutschland, Europa und weltweit.
      Ideal fÃ¼r Pendler, Roadtrips, Urlaubsfahrten und faire Kostenaufteilung pro Person.
      <span style="opacity:.75;margin-left:10px">|</span>
      <a href="/faq.html">FAQ</a> <span style="opacity:.75">|</span>
      <a href="/impressum.html">Impressum</a> <span style="opacity:.75">|</span>
      <a href="/datenschutz.html">Datenschutz</a> <span style="opacity:.75">|</span>
      <a href="/ratgeber.html">Ratgeber</a> <span style="opacity:.75">|</span>
      <a href="/contact.html">Kontakt</a>

      <div style="text-align:center;opacity:.8;margin-top:14px">
        Deutsch:
        <a href="https://spritkosten-check.de/" hreflang="de" lang="de">Spritkosten-Check.de</a>
        &nbsp;&nbsp;|&nbsp;&nbsp;
        Englisch:
        <a href="https://petrolcostcalculator.com/" hreflang="en" lang="en">PetrolCostCalculator.com</a>
      </div>
    </footer>

  </div>

  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
  <script src="prices/country-prices.js"></script>

  <script>
    document.addEventListener('DOMContentLoaded', () => {
      const CURRENCY_SYMBOL = 'â‚¬';

      // Optional: Tankerkoenig (DE) â€“ spÃ¤ter fÃ¼r "GÃ¼nstig tanken" Seite nÃ¼tzlich
      const TANKERKOENIG_API_KEY = "";

      const parse = v => (v === '' || v == null) ? NaN : Number(String(v).replace(',', '.'));
      const fmt = n => (Number.isFinite(n) ? Number.parseFloat(n.toFixed(2)).toFixed(2) : '0.00');
      const fmtMoney = n => CURRENCY_SYMBOL + fmt(n).replace('.', ',');
      const fmtL = n => fmt(n).replace('.', ',');
      const fmtKg = n => (Number.isFinite(n) ? (Math.round(n * 10) / 10).toFixed(1).replace('.', ',') : 'â€”') + ' kg';

      // Tabs (Spritkosten / Taschenrechner)
      const tabButtons = document.querySelectorAll('.tabs [role="tab"]');
      tabButtons.forEach(btn => {
        btn.addEventListener('click', () => {
          tabButtons.forEach(b => b.setAttribute('aria-selected','false'));
          btn.setAttribute('aria-selected','true');
          const target = btn.dataset.target;

          document.querySelectorAll('main > section').forEach(s => {
            const isActive = (s.id === target);
            s.style.display = isActive ? '' : 'none';
            s.setAttribute('aria-hidden', isActive ? 'false' : 'true');
          });

          if (target === 'fuel') setTimeout(() => { try { map.invalidateSize(); } catch(e){} }, 80);
        });
      });

      function fetchWithTimeout(url, ms=12000){
        const controller = new AbortController();
        const t = setTimeout(() => controller.abort(), ms);
        return fetch(url, { signal: controller.signal }).finally(() => clearTimeout(t));
      }

      // DOM
      const kmEl = document.getElementById('km');
      const consumptionEl = document.getElementById('consumption');
      const priceEl = document.getElementById('price');
      const passengersEl = document.getElementById('passengers');
      const fuelTypeEl = document.getElementById('fuel-type');

      const litersEl = document.getElementById('liters');
      const costFuelEl = document.getElementById('cost-fuel');
      const costRunningEl = document.getElementById('cost-running');
      const costTotalEl = document.getElementById('cost-total');
      const costPersonEl = document.getElementById('cost-person');
      const avg100El = document.getElementById('avg100');
      const runningEstEl = document.getElementById('running-est');

      const avgUnleaded91El = document.getElementById('avg-unleaded91');
      const avgUnleaded95El = document.getElementById('avg-unleaded95');
      const avgDieselEl = document.getElementById('avg-diesel');

      const tollInfoEl = document.getElementById('toll-info');
      const priceInfoEl = document.getElementById('price-info');

      const placeFromEl = document.getElementById('place-from');
      const placeToEl = document.getElementById('place-to');

      const badgeEl = document.getElementById('country-badge');
      const priceModeWrap = document.getElementById('price-mode');

      const tollTotalEl = document.getElementById('toll-total');
      const vignetteTotalEl = document.getElementById('vignette-total');
      const tollVignetteSumEl = document.getElementById('toll-vignette-sum');
      const tollBreakdownEl = document.getElementById('toll-breakdown');

      // CO2 DOM
      const co2LitersEl = document.getElementById('co2-liters');
      const co2TotalEl = document.getElementById('co2-total');
      const co2PerPersonEl = document.getElementById('co2-per-person');
      const co2Per100El = document.getElementById('co2-per-100');
      const cmpCarEl = document.getElementById('cmp-car');
      const cmpRailEl = document.getElementById('cmp-rail');
      const cmpFlightEl = document.getElementById('cmp-flight');

      // Emissionsfaktoren (grobe NÃ¤herung)
      const CO2_PER_LITER = { unleaded91: 2.31, unleaded95: 2.31, diesel: 2.65 };
      // Vergleichswerte (g CO2 pro Person-km, grob)
      const COMPARE_G_PER_PKM = { rail: 41, flight: 255 };

      function resetCO2UI(){
        co2LitersEl.textContent = 'â€”';
        co2TotalEl.textContent = 'â€”';
        co2PerPersonEl.textContent = 'â€”';
        co2Per100El.textContent = 'â€”';
        cmpCarEl.textContent = 'â€”';
        cmpRailEl.textContent = 'â€”';
        cmpFlightEl.textContent = 'â€”';
      }
      resetCO2UI();

      // Preise aus externer Datei
      const countryPrices = window.COUNTRY_FUEL_PRICES_EUR || null;
      const priceStand = window.COUNTRY_FUEL_PRICES_STAND || '';

      const fallbackPrices = { unleaded91: 1.50, unleaded95: 1.60, diesel: 1.45, name:'Fallback' };
      let fuelPrices = { ...fallbackPrices };
      let userEditedPrice = false;

      // Route state
      let startCC = null, destCC = null;
      let routeKm = 0;

      // Maut state
      let lastTollTotal = 0;
      let lastVignetteTotal = 0;

      function renderAvgPrices(){
        avgUnleaded91El.textContent = fmtMoney(fuelPrices.unleaded91);
        avgUnleaded95El.textContent = fmtMoney(fuelPrices.unleaded95);
        avgDieselEl.textContent = fmtMoney(fuelPrices.diesel);
      }
      renderAvgPrices();

      function getMode(){
        const el = document.querySelector('input[name="priceMode"]:checked');
        return el ? el.value : 'avg';
      }

      function getCountryName(cc){
        if(!cc) return 'â€”';
        const e = countryPrices && countryPrices[cc];
        return (e && e.name) ? e.name : cc;
      }

      function pricesForCountryStatic(cc){
        const code = (cc || '').toUpperCase();
        const entry = countryPrices && countryPrices[code];
        if(entry && Number.isFinite(entry.unleaded91) && Number.isFinite(entry.unleaded95) && Number.isFinite(entry.diesel)){
          return { ...entry, source: 'static' };
        }
        return { ...fallbackPrices, name: code || 'Fallback', source: 'fallback' };
      }

      function mixPrices(a, b){
        return {
          unleaded91: (a.unleaded91 + b.unleaded91) / 2,
          unleaded95: (a.unleaded95 + b.unleaded95) / 2,
          diesel:     (a.diesel + b.diesel) / 2,
          name: `${a.name} / ${b.name}`,
          source: 'avg'
        };
      }

      async function applyDetectedPrices(){
        if(!countryPrices){
          badgeEl.innerHTML = '<span class="error">Preisdatei nicht geladen: prices/country-prices.js</span>';
        }

        const isCross = (startCC && destCC && startCC !== destCC);
        const mode = isCross ? getMode() : 'start';

        const startP = pricesForCountryStatic(startCC);
        const destP  = pricesForCountryStatic(destCC);

        let chosen, note;
        if(isCross){
          if(mode === 'start'){ chosen = startP; note = `Startland (${startP.name})`; }
          else if(mode === 'dest'){ chosen = destP; note = `Zielland (${destP.name})`; }
          else { chosen = mixPrices(startP, destP); note = `Mittelwert (${startP.name} â†” ${destP.name})`; }
        }else{
          chosen = startP;
          note = startCC ? `Land: ${chosen.name}` : 'Land: â€”';
        }

        fuelPrices = { unleaded91: chosen.unleaded91, unleaded95: chosen.unleaded95, diesel: chosen.diesel };
        renderAvgPrices();

        if(!userEditedPrice){
          priceEl.value = fuelPrices[fuelTypeEl.value] ?? '';
          const standTxt = priceStand ? ` (Stand: ${priceStand})` : '';
          priceInfoEl.textContent = `${note}. Quelle: LÃ¤nderpreise (statisch)${standTxt}. Du kannst den Preis Ã¤ndern.`;
          priceInfoEl.classList.remove('error');
        }
      }

      fuelTypeEl.addEventListener('change', () => {
        if(!userEditedPrice){
          priceEl.value = fuelPrices[fuelTypeEl.value] ?? '';
        }
      });

      priceEl.addEventListener('input', () => {
        userEditedPrice = true;
        priceInfoEl.textContent = '';
        priceInfoEl.classList.remove('error');
      });

      document.getElementById('btn-reset-price').addEventListener('click', async () => {
        userEditedPrice = false;
        await applyDetectedPrices();
      });

      document.querySelectorAll('input[name="priceMode"]').forEach(r => {
        r.addEventListener('change', async () => {
          if(!userEditedPrice && startCC && destCC) await applyDetectedPrices();
          renderTollBreakdown();
        });
      });

      // Map
      const map = L.map('map', { attributionControl:true }).setView([51.1657, 10.4515], 5);
      L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
        maxZoom:19,
        attribution:'&copy; OpenStreetMap-Mitwirkende'
      }).addTo(map);

      setTimeout(() => { try { map.invalidateSize(); } catch(e){} }, 150);
      window.addEventListener('resize', () => {
        setTimeout(() => { try { map.invalidateSize(); } catch(e){} }, 150);
      });

      let markers = [];
      let routeLayer = null;

      function clearMarkers(){ markers.forEach(m=>map.removeLayer(m)); markers=[]; }
      function clearRoute(){ if(routeLayer){ map.removeLayer(routeLayer); routeLayer=null; } }
      function addMarker(lat, lon, label){
        const m = L.marker([lat, lon]).addTo(map).bindPopup(label || '');
        markers.push(m);
        return m;
      }

      async function geocode(q){
        const url = 'https://nominatim.openstreetmap.org/search?format=json&limit=1&q=' + encodeURIComponent(q);
        const res = await fetchWithTimeout(url, 12000);
        if(!res.ok) throw new Error('Geocoding fehlgeschlagen');
        const data = await res.json();
        if(data?.length) return { lat:+data[0].lat, lon:+data[0].lon, name:data[0].display_name };
        return null;
      }

      async function reverseCountryCode(lat, lon){
        const url = `https://nominatim.openstreetmap.org/reverse?format=json&lat=${encodeURIComponent(lat)}&lon=${encodeURIComponent(lon)}`;
        const res = await fetchWithTimeout(url, 12000);
        if(!res.ok) return null;
        const j = await res.json();
        return j?.address?.country_code ? String(j.address.country_code).toUpperCase() : null;
      }

      // OSRM Routing
      async function getRouteOSRM(lat1, lon1, lat2, lon2){
        const url =
          `https://router.project-osrm.org/route/v1/driving/` +
          `${encodeURIComponent(lon1)},${encodeURIComponent(lat1)};${encodeURIComponent(lon2)},${encodeURIComponent(lat2)}` +
          `?overview=full&geometries=geojson&alternatives=false&steps=false`;

        const res = await fetchWithTimeout(url, 15000);
        if(!res.ok) throw new Error('OSRM request failed');
        const j = await res.json();
        if(!j || j.code !== 'Ok' || !j.routes || !j.routes.length) throw new Error('OSRM no route');

        const r = j.routes[0];
        const distKm = (r.distance || 0) / 1000;

        clearRoute();
        routeLayer = L.geoJSON(r.geometry, { style: { weight: 5, opacity: 0.9 } }).addTo(map);
        map.fitBounds(routeLayer.getBounds(), { padding:[60,60] });

        return distKm;
      }

      // Maut (â‚¬/100 km) â€“ grobe LÃ¤nderwerte
      const tollPer100km = {
        DE:0, AT:6, CH:4, FR:10, IT:9, ES:10, NL:0, BE:0,
        PL:6, CZ:4, SK:4, HU:5, SI:5, HR:5, RO:3, BG:3,
        US:3, CA:2, GB:0, AU:5, RU:1
      };

      // Vignetten (Fixbetrag) â€“ grobe NÃ¤herung
      const vignetteFlat = {
        AT: 11.50, CH: 40.00, CZ: 12.00, SK: 12.00, HU: 16.00, SI: 16.00, RO: 3.50, BG: 7.50
      };

      function estimateTollForCountry(cc, km){
        const rate = (tollPer100km[cc] ?? 5);
        return Math.round(((km / 100) * rate) * 100) / 100;
      }

      function estimateVignetteForCountry(cc){
        const v = vignetteFlat[cc];
        return Number.isFinite(v) ? v : 0;
      }

      function renderTollBreakdown(){
        if(!routeKm || !startCC){
          tollTotalEl.textContent = 'â€”';
          vignetteTotalEl.textContent = 'â€”';
          tollVignetteSumEl.textContent = 'â€”';
          tollBreakdownEl.textContent = 'Gib Start/Ziel ein und berechne die Strecke.';
          return;
        }

        const isCross = (startCC && destCC && startCC !== destCC);
        const parts = [];

        if(!isCross){
          parts.push({ cc: startCC, km: routeKm });
        } else {
          const half = routeKm / 2;
          parts.push({ cc: startCC, km: half });
          parts.push({ cc: destCC, km: routeKm - half });
        }

        let tollSum = 0;
        let vignetteSum = 0;
        const seen = new Set();

        const lines = parts.map(p => {
          const name = getCountryName(p.cc);
          const toll = estimateTollForCountry(p.cc, p.km);
          tollSum += toll;

          if(!seen.has(p.cc)){
            vignetteSum += estimateVignetteForCountry(p.cc);
            seen.add(p.cc);
          }

          const rate = (tollPer100km[p.cc] ?? 5);
          return `â€¢ ${name} (${p.cc}): ${fmtL(p.km)} km Ã— ${fmt(rate).replace('.', ',')} â‚¬/100 km â‰ˆ <b>${fmtMoney(toll)}</b>`;
        });

        lastTollTotal = tollSum;
        lastVignetteTotal = vignetteSum;

        tollTotalEl.textContent = fmtMoney(tollSum);
        vignetteTotalEl.textContent = fmtMoney(vignetteSum);
        tollVignetteSumEl.textContent = fmtMoney(tollSum + vignetteSum);

        tollBreakdownEl.innerHTML =
          lines.join('<br>') +
          (vignetteSum > 0 ? `<br><br><span class="small">Vignetten (fix, je Land einmal): ${fmtMoney(vignetteSum)}</span>` : '') +
          `<br><span class="small">Hinweis: LÃ¤nder-Split ist eine schnelle SchÃ¤tzung (bei LÃ¤nderwechsel 50/50).</span>`;
      }

      function updateCO2AndCompare({ km, liters, passengers, fuelKey }){
        if(!Number.isFinite(km) || km <= 0 || !Number.isFinite(liters) || liters < 0) return;

        const factor = CO2_PER_LITER[fuelKey] ?? 2.31;
        const co2Total = liters * factor; // kg
        const co2PerPerson = co2Total / Math.max(1, passengers);
        const co2Per100 = (co2Total / km) * 100;

        co2LitersEl.textContent = fmtL(liters) + ' L';
        co2TotalEl.textContent = fmtKg(co2Total);
        co2PerPersonEl.textContent = fmtKg(co2PerPerson);
        co2Per100El.textContent = fmtKg(co2Per100);

        const railPerPerson = (km * COMPARE_G_PER_PKM.rail) / 1000;     // kg
        const flightPerPerson = (km * COMPARE_G_PER_PKM.flight) / 1000; // kg

        cmpCarEl.textContent = fmtKg(co2PerPerson) + ' / Person';
        cmpRailEl.textContent = fmtKg(railPerPerson) + ' / Person';
        cmpFlightEl.textContent = fmtKg(flightPerPerson) + ' / Person';
      }

      // Events
      document.getElementById('btn-geocode').addEventListener('click', async () => {
        const from = placeFromEl.value.trim();
        const to = placeToEl.value.trim();
        if(!from || !to){
          tollInfoEl.textContent = 'Bitte Start und Ziel eingeben.';
          tollInfoEl.classList.add('error');
          return;
        }

        try{
          tollInfoEl.textContent = 'Route wird berechnetâ€¦';
          tollInfoEl.classList.remove('error');

          const a = await geocode(from);
          const b = await geocode(to);
          if(!a || !b){
            tollInfoEl.textContent = 'Ort nicht gefunden. Bitte genauer eingeben.';
            tollInfoEl.classList.add('error');
            return;
          }

          startCC = await reverseCountryCode(a.lat, a.lon);
          destCC  = await reverseCountryCode(b.lat, b.lon);

          const startName = getCountryName(startCC);
          const destName  = getCountryName(destCC);

          badgeEl.innerHTML =
            `Erkannt: <b>Start</b> ${startName} (${startCC||'â€”'}), <b>Ziel</b> ${destName} (${destCC||'â€”'})` +
            (!countryPrices ? `<br><span class="error">âš  Preisdatei fehlt: prices/country-prices.js</span>` : '');

          if(startCC && destCC && startCC !== destCC) priceModeWrap.style.display = 'block';
          else priceModeWrap.style.display = 'none';

          clearMarkers();
          addMarker(a.lat,a.lon,'Start: ' + a.name);
          addMarker(b.lat,b.lon,'Ziel: ' + b.name);

          routeKm = await getRouteOSRM(a.lat, a.lon, b.lat, b.lon);
          kmEl.value = Math.round(routeKm*10)/10;

          await applyDetectedPrices();
          renderTollBreakdown();

          const isCross = (startCC && destCC && startCC !== destCC);
          const mode = isCross ? getMode() : 'start';
          const modeText = isCross ? (mode === 'avg' ? 'Mittelwert' : (mode === 'start' ? 'Startland' : 'Zielland')) : 'Startland';
          tollInfoEl.textContent = `Strecke (OSRM): ${fmtL(routeKm)} km. Spritpreis-Modus: ${modeText}.`;

          setTimeout(() => { try { map.invalidateSize(); } catch(e){} }, 80);
        }catch(e){
          tollInfoEl.textContent = 'Fehler bei Routing/Geocoding. Bitte Verbindung prÃ¼fen oder anderen Ort versuchen.';
          tollInfoEl.classList.add('error');
        }
      });

      document.getElementById('btn-clearmap').addEventListener('click', () => {
        clearMarkers();
        clearRoute();
        map.setView([51.1657, 10.4515], 5);

        placeFromEl.value = '';
        placeToEl.value = '';
        badgeEl.textContent = '';
        priceModeWrap.style.display = 'none';

        startCC = null; destCC = null;
        routeKm = 0;

        tollInfoEl.textContent = '';
        tollInfoEl.classList.remove('error');

        renderTollBreakdown();
        setTimeout(() => { try { map.invalidateSize(); } catch(e){} }, 80);
      });

      document.getElementById('km-inc').addEventListener('click', ()=>{ const cur = parse(kmEl.value)||0; kmEl.value = Math.round((cur+1)*10)/10; });
      document.getElementById('km-dec').addEventListener('click', ()=>{ const cur = parse(kmEl.value)||0; kmEl.value = Math.max(0, Math.round((cur-1)*10)/10); });

      function estimateRunningPer100(consumptionL100){
        if(!Number.isFinite(consumptionL100) || consumptionL100 <= 0) return 12.0;
        const est = 1.2 * consumptionL100 + 3.5;
        return Math.max(5, Math.min(30, Math.round(est * 10) / 10));
      }

      document.getElementById('calc-fuel').addEventListener('click', () => {
        const km = parse(kmEl.value);
        const v  = parse(consumptionEl.value);
        let p    = parse(priceEl.value);
        const passengers = Math.max(1, Math.floor(parse(passengersEl.value) || 1));

        if(!Number.isFinite(p)){
          p = (fuelPrices[fuelTypeEl.value] ?? NaN);
        }

        if(Number.isNaN(km) || km <= 0 || Number.isNaN(v) || Number.isNaN(p)){
          priceInfoEl.textContent = 'Bitte Strecke, Verbrauch und Preis korrekt eingeben.';
          priceInfoEl.classList.add('error');
          return;
        }
        priceInfoEl.textContent = '';
        priceInfoEl.classList.remove('error');

        const liters = (km * v) / 100;
        const costFuel = liters * p;

        const runningPer100Base = estimateRunningPer100(v);
        const tollPer100 = (km > 0) ? ((lastTollTotal + lastVignetteTotal) / km * 100) : 0;
        const runningPer100Total = runningPer100Base + (tollPer100 || 0);

        const costRunning = (km * runningPer100Total) / 100;
        const total = costFuel + costRunning;
        const perPerson = total / passengers;
        const avgPer100 = (total / km) * 100;

        litersEl.textContent = fmtL(liters) + ' L';
        costFuelEl.textContent = fmtMoney(costFuel);
        costRunningEl.textContent = fmtMoney(costRunning);
        costTotalEl.textContent = fmtMoney(total);
        costPersonEl.textContent = fmtMoney(perPerson);
        avg100El.textContent = fmtMoney(avgPer100) + ' /100km';
        runningEstEl.textContent = fmtMoney(runningPer100Total) + ' /100km';

        updateCO2AndCompare({ km, liters, passengers, fuelKey: fuelTypeEl.value });
      });

      document.getElementById('reset-fuel').addEventListener('click', () => {
        kmEl.value = '';
        consumptionEl.value = '7.5';
        priceEl.value = '';
        passengersEl.value = 1;

        litersEl.textContent='0,00 L';
        costFuelEl.textContent='â‚¬0,00';
        costRunningEl.textContent='â‚¬0,00';
        costTotalEl.textContent='â‚¬0,00';
        costPersonEl.textContent='â‚¬0,00';
        avg100El.textContent='â‚¬0,00 /100km';
        runningEstEl.textContent='â€”';

        userEditedPrice = false;
        fuelPrices = { ...fallbackPrices };
        renderAvgPrices();

        lastTollTotal = 0;
        lastVignetteTotal = 0;
        renderTollBreakdown();

        clearMarkers();
        clearRoute();
        map.setView([51.1657, 10.4515],5);
        setTimeout(() => { try { map.invalidateSize(); } catch(e){} }, 80);

        resetCO2UI();
      });

      // Taschenrechner
      const num1 = document.getElementById('num1');
      const num2 = document.getElementById('num2');
      const result = document.getElementById('result');
      document.querySelectorAll('[data-op]').forEach(btn =>
        btn.addEventListener('click', () => {
          const a = parse(num1.value), b = parse(num2.value);
          if(Number.isNaN(a) || Number.isNaN(b)){ result.textContent = 'â€“'; return; }
          let res;
          switch(btn.dataset.op){
            case '+': res = a + b; break;
            case '-': res = a - b; break;
            case '*': res = a * b; break;
            case '/': res = (b === 0 ? 'âˆž' : a / b); break;
          }
          result.textContent = (typeof res === 'number') ? fmt(res).replace('.', ',') : res;
        })
      );

      renderTollBreakdown();
      setTimeout(() => { try { map.invalidateSize(); } catch(e){} }, 120);
    });
  </script>
</body>
</html>
